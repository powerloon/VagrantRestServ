<!DOCTYPE html>
<html>
  <head>
    <title>VagrantRestServ</title>
    <!-- <link rel="stylesheet" type="text/css" href="css/mycss.css"> -->
  </head>
  <body>
    <input type="text" id="command" placeholder="insert command here" value="ls"></input>
    <button id="command-button">Run</button>
    <p id="result"></p>
    <script type="text/javascript" src="//code.jquery.com/jquery-2.1.3.min.js"></script>
    <!--<script type="text/javascript" src="js/myjs.js"></script>-->
    <script>
      $('#command-button').click(function(){
          var command = $('#command').val();
          $.post( "/run", JSON.stringify({ command: command })).done(function( data ) {
            $('#result').html(data);
          }).error(function(){
            $('#result').html("INVALID COMMAND");
          });
      });


      window.onload = function(){
        (function(){
          var show = function(el){
            return function(msg){ el.innerHTML = msg + '<br />' + el.innerHTML; }
          }(document.getElementById('msgs'));

          var ws       = new WebSocket('ws://' + window.location.host + window.location.pathname);
          ws.onopen    = function()  { show('websocket opened'); };
          ws.onclose   = function()  { show('websocket closed'); }
          ws.onmessage = function(m) { show('websocket message: ' +  m.data); };

          var sender = function(f){
            var input     = document.getElementById('input');
            input.onclick = function(){ input.value = "" };
            f.onsubmit    = function(){
              ws.send(input.value);
              input.value = "send a message";
              return false;
            }
          }(document.getElementById('form'));
        })();
      }
    </script>
  </body>
</html>